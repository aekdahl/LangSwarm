workflows:
  main_workflow:
    - id: daytona_workflow
      description: "Workflow for Daytona self-hosted workspace management"
      inputs:
        - user_input
      steps:
        - id: parse_request
          agent: intent_and_param_extractor
          input: |
            User request: ${user_input}
            
            Parse this request and extract the operation and parameters.
          output:
            to: execute_operation

        - id: execute_operation
          function: langswarm.core.utils.workflows.functions.mcp_call
          args:
            mcp_url: "local://daytona_self_hosted"
            payload:
              name: ${context.step_outputs.parse_request.operation}
              arguments: ${context.step_outputs.parse_request}
          output:
            to:
              - condition:
                  if: "${context.step_outputs.execute_operation.error} == None"
                  then: format_response
                  else: handle_error

        - id: format_response
          agent: response_formatter
          input: |
            Operation: ${context.step_outputs.parse_request.operation}
            Result: ${context.step_outputs.execute_operation}
            
            Format this result for the user.
          output:
            to: user

        - id: handle_error
          agent: error_handler
          input: |
            Operation: ${context.step_outputs.parse_request.operation}
            Error: ${context.step_outputs.execute_operation}
            
            Explain this error to the user.
          output:
            to: user
